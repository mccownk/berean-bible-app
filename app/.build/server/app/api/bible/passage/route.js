"use strict";(()=>{var e={};e.id=372,e.ids=[372],e.modules={53524:e=>{e.exports=require("@prisma/client")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{e.exports=require("assert")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},86624:e=>{e.exports=require("querystring")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},71568:e=>{e.exports=require("zlib")},75093:(e,a,t)=>{t.r(a),t.d(a,{originalPathname:()=>T,patchFetch:()=>j,requestAsyncStorage:()=>y,routeModule:()=>w,serverHooks:()=>S,staticGenerationAsyncStorage:()=>A});var r={};t.r(r),t.d(r,{GET:()=>E,dynamic:()=>b});var n=t(79182),i=t(72007),s=t(56719),o=t(93442),l=t(57978),c=t(11826),d=t(85819);async function u(e,a="text"){try{let t=e.join(";"),r=await fetch(`https://api.esv.org/v3${"html"===a?"/passage/html":"/passage/text"}?q=${encodeURIComponent(t)}`,{headers:{Authorization:`Token ${process.env.ESV_API_KEY}`,"Content-Type":"application/json"}});if(!r.ok)return console.error("ESV API Error:",r.status,r.statusText),null;return await r.json()}catch(e){return console.error("Error fetching Bible passage:",e),null}}function p(e){return`
    This is a mock Bible passage for ${e.join(", ")}.
    
    In the beginning was the Word, and the Word was with God, and the Word was God. 
    He was in the beginning with God. All things were made through him, and without 
    him was not any thing made that was made. In him was life, and the life was the 
    light of men. The light shines in the darkness, and the darkness has not overcome it.
    
    There was a man sent from God, whose name was John. He came as a witness, to bear 
    witness about the light, that all might believe through him. He was not the light, 
    but came to bear witness about the light.
    
    The true light, which gives light to everyone, was coming into the world. He was 
    in the world, and the world was made through him, yet the world did not know him.
    
    [This is mock content for development purposes. In production, this would be replaced 
    with actual ESV Bible text from the ESV API.]
  `.trim()}let h={matthew:"MAT",matt:"MAT",mt:"MAT",mark:"MRK",mk:"MRK",luke:"LUK",lk:"LUK",john:"JHN",jn:"JHN",acts:"ACT",romans:"ROM",rom:"ROM","1 corinthians":"1CO","1co":"1CO","1 cor":"1CO","2 corinthians":"2CO","2co":"2CO","2 cor":"2CO",galatians:"GAL",gal:"GAL",ephesians:"EPH",eph:"EPH",philippians:"PHP",phil:"PHP",colossians:"COL",col:"COL","1 thessalonians":"1TH","1th":"1TH","1 thess":"1TH","2 thessalonians":"2TH","2th":"2TH","2 thess":"2TH","1 timothy":"1TI","1ti":"1TI","1 tim":"1TI","2 timothy":"2TI","2ti":"2TI","2 tim":"2TI",titus:"TIT",tit:"TIT",philemon:"PHM",phm:"PHM",hebrews:"HEB",heb:"HEB",james:"JAS",jas:"JAS","1 peter":"1PE","1pe":"1PE","1 pet":"1PE","2 peter":"2PE","2pe":"2PE","2 pet":"2PE","1 john":"1JN","1jn":"1JN","2 john":"2JN","2jn":"2JN","3 john":"3JN","3jn":"3JN",jude:"JUD",jud:"JUD",revelation:"REV",rev:"REV",genesis:"GEN",gen:"GEN",exodus:"EXO",exo:"EXO",leviticus:"LEV",lev:"LEV",numbers:"NUM",num:"NUM",deuteronomy:"DEU",deut:"DEU",joshua:"JOS",josh:"JOS",judges:"JDG",judg:"JDG",ruth:"RUT",rut:"RUT","1 samuel":"1SA","1sa":"1SA","1 sam":"1SA","2 samuel":"2SA","2sa":"2SA","2 sam":"2SA","1 kings":"1KI","1ki":"1KI","2 kings":"2KI","2ki":"2KI","1 chronicles":"1CH","1ch":"1CH","1 chron":"1CH","2 chronicles":"2CH","2ch":"2CH","2 chron":"2CH",ezra:"EZR",ezr:"EZR",nehemiah:"NEH",neh:"NEH",esther:"EST",est:"EST",job:"JOB",psalms:"PSA",psalm:"PSA",psa:"PSA",proverbs:"PRO",prov:"PRO",ecclesiastes:"ECC",eccl:"ECC","song of songs":"SNG",song:"SNG",isaiah:"ISA",isa:"ISA",jeremiah:"JER",jer:"JER",lamentations:"LAM",lam:"LAM",ezekiel:"EZK",ezek:"EZK",daniel:"DAN",dan:"DAN",hosea:"HOS",hos:"HOS",joel:"JOL",amos:"AMO",obadiah:"OBA",obad:"OBA",jonah:"JON",jon:"JON",micah:"MIC",mic:"MIC",nahum:"NAM",nah:"NAM",habakkuk:"HAB",hab:"HAB",zephaniah:"ZEP",zeph:"ZEP",haggai:"HAG",hag:"HAG",zechariah:"ZEC",zech:"ZEC",malachi:"MAL",mal:"MAL"};async function g(e,a="text",t="ESV"){try{let r=[],n=[];for(let i of e){let e=function(e){try{let a=e.trim().match(/^(.+?)\s+(\d+)(?:[:\.](\d+))?(?:-(\d+))?$/);if(!a)throw Error(`Invalid passage format: ${e}`);let[,t,r,n,i]=a,s=h[t.toLowerCase().trim()];if(!s)throw Error(`Unknown book: ${t}`);if(!n)return`${s}.${r}`;if(i)return`${s}.${r}.${n}-${s}.${r}.${i}`;return`${s}.${r}.${n}`}catch(e){throw console.error("Error parsing passage reference:",e),e}}(i),s=await fetch(`https://api.scripture.api.bible/v1/bibles/${t}/passages/${e}`,{headers:{"api-key":process.env.BIBLE_API_KEY||"","Content-Type":"application/json"}});if(!s.ok){console.error("Bible API Error:",s.status,s.statusText);let e=await s.text();console.error("Error details:",e);continue}let o=await s.json(),l=o.data.content;"text"===a&&l&&(l=l.replace(/<[^>]*>/g,"").replace(/\s+/g," ").trim()),r.push(l||""),n.push(o.data.reference||i)}if(0===r.length)return null;return{query:e.join(";"),canonical:n.join("; "),reference:n.join("; "),passages:r,bibleId:t,translation:({ESV:"ESV",esv:"ESV","bba9f40183526463-01":"BSB","de4e12af7f28f599-01":"KJV","de4e12af7f28f599-02":"KJV","06125adad2d5898a-01":"ASV","685d1470fe4d5c3b-01":"ASVBT","55212e3cf5d04d49-01":"KJVCPB","01b29f4b342acc35-01":"LSV","9879dbb7cfe39e4d-01":"WEB","9879dbb7cfe39e4d-02":"WEB","9879dbb7cfe39e4d-03":"WEB","9879dbb7cfe39e4d-04":"WEB","65eec8e0b60e656b-01":"FBV","179568874c45066f-01":"DRA","c315fa9f71d4af3a-01":"GNV"})[t]||"Unknown"}}catch(e){return console.error("Error fetching Bible passage:",e),null}}async function m(e,a="text",t="ESV"){try{let r=t;try{await (0,d.AH)(t)||(console.warn(`Unknown translation ID: ${t}, falling back to default`),r="ESV")}catch(e){console.warn("Error validating translation, using provided ID:",e)}if((0,d.we)(r)){let t=await u(e,a);if(t)return{query:t.query,canonical:t.canonical,reference:t.canonical,passages:t.passages,bibleId:"ESV",translation:"ESV"};console.warn("ESV API failed, falling back to Bible API with BSB"),r="bba9f40183526463-01"}let n=await g(e,a,r);if(n)return n;if("bba9f40183526463-01"!==r){console.warn(`${r} failed, trying BSB fallback`);let t=await g(e,a,"bba9f40183526463-01");if(t)return t}throw Error("All translation sources failed")}catch(r){console.error("Error in unified Bible service:",r);let a=p(e);return{query:e.join(";"),canonical:e.join("; "),reference:e.join("; "),passages:[a],bibleId:t,translation:(0,d.we)(t)?"ESV":"Mock"}}}var f=t(83178);let b="force-dynamic";async function E(e){try{let a=await (0,l.getServerSession)(c.L);if(!a)return o.NextResponse.json({message:"Unauthorized"},{status:401});let{searchParams:t}=new URL(e.url),r=t.get("passages"),n=t.get("translation");if(!r)return o.NextResponse.json({message:"Passages parameter is required"},{status:400});let i=r.split(",").map(e=>e.trim()),s="ESV";if(n)s=n;else try{let e=await f._.user.findUnique({where:{id:a.user.id},select:{preferredTranslation:!0}});e?.preferredTranslation&&(s=e.preferredTranslation)}catch(e){console.error("Error fetching user translation preference:",e)}let d=await m(i,"text",s);if(!d){let e=p(i);return o.NextResponse.json({passages:i,content:e,reference:i.join(", "),translation:s})}return o.NextResponse.json({passages:i,content:d.passages[0],reference:d.reference,translation:d.translation})}catch(e){return console.error("Bible passage API error:",e),o.NextResponse.json({message:"Internal server error"},{status:500})}}let w=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/bible/passage/route",pathname:"/api/bible/passage",filename:"route",bundlePath:"app/api/bible/passage/route"},resolvedPagePath:"/home/ubuntu/berean-bible-app/app/app/api/bible/passage/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:y,staticGenerationAsyncStorage:A,serverHooks:S}=w,T="/api/bible/passage/route";function j(){return(0,s.patchFetch)({serverHooks:S,staticGenerationAsyncStorage:A})}},11826:(e,a,t)=>{t.d(a,{L:()=>o});var r=t(64617),n=t(66291),i=t(81304),s=t(83178);let o={adapter:(0,r.N)(s._),providers:[(0,n.Z)({name:"credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)return null;let a=await s._.user.findUnique({where:{email:e.email}});return a&&a.password&&await i.ZP.compare(e.password,a.password)?{id:a.id,email:a.email,name:a.name,image:a.image}:null}})],session:{strategy:"jwt",maxAge:2592e3},callbacks:{jwt:async({token:e,user:a})=>(a&&(e.id=a.id),e),session:async({session:e,token:a})=>(a&&(e.user.id=a.id),e)},secret:process.env.NEXTAUTH_SECRET}},83178:(e,a,t)=>{t.d(a,{_:()=>n});var r=t(53524);let n=globalThis.prisma??new r.PrismaClient},85819:(e,a,t)=>{t.d(a,{AH:()=>c,DF:()=>l,tS:()=>o,we:()=>d});let r=null,n=0,i=new Set(["ESV","bba9f40183526463-01","de4e12af7f28f599-01","de4e12af7f28f599-02","9879dbb7cfe39e4d-04","06125adad2d5898a-01","01b29f4b342acc35-01","65eec8e0b60e656b-01"]);async function s(){try{let e=await fetch("https://api.scripture.api.bible/v1/bibles",{headers:{"api-key":process.env.BIBLE_API_KEY||"","Content-Type":"application/json"}});if(!e.ok)return console.error("Bible API Error:",e.status,e.statusText),[];let a=(await e.json()).data.filter(e=>"eng"===e.language.id).map(e=>({id:e.id,name:e.name,abbreviation:e.abbreviation,language:e.language,description:e.description||e.descriptionLocal,category:function(e){let a=e.abbreviation?.toUpperCase(),t=e.name?.toLowerCase()||"";return i.has(e.id)||"ESV"===a?"popular":a?.includes("KJV")||"ASV"===a||"RV"===a||t.includes("king james")||t.includes("authorised")||t.includes("american standard")||t.includes("revised version")?"traditional":"WEB"===a||"WEBBE"===a||"LSV"===a||"FBV"===a||"BSB"===a||t.includes("literal standard")||t.includes("world english")||t.includes("free bible")?"modern":t.includes("messianic")||t.includes("jewish")||t.includes("orthodox")||t.includes("septuagint")||a?.includes("OJB")||a?.includes("TOJB")?"specialized":t.includes("douay")||t.includes("rheims")||t.includes("geneva")||t.includes("byzantine")||t.includes("majority text")||t.includes("targum")||t.includes("1885")||t.includes("1917")?"historical":"modern"}(e),source:"api_bible",type:e.type,updatedAt:e.updatedAt})),t=[{id:"ESV",name:"English Standard Version",abbreviation:"ESV",language:{id:"eng",name:"English",nameLocal:"English",script:"Latin",scriptDirection:"LTR"},description:"Modern literal translation - Primary source via ESV API",category:"popular",source:"esv",type:"text"},...a],r={popular:0,modern:1,traditional:2,specialized:3,historical:4};return t.sort((e,a)=>{let t=r[e.category],n=r[a.category];if(t!==n)return t-n;if("popular"===e.category&&"popular"===a.category){if("ESV"===e.id)return -1;if("ESV"===a.id)return 1;if(i.has(e.id)&&!i.has(a.id))return -1;if(!i.has(e.id)&&i.has(a.id))return 1}return e.abbreviation.localeCompare(a.abbreviation)}),t}catch(e){return console.error("Error fetching available translations:",e),[]}}async function o(e=!1){let a=Date.now();if(!e&&r&&a-n<864e5)return r;let t=await s();return r=t,n=a,t}async function l(e=!1){let a=await o(e);return[{category:"popular",label:"Popular Translations",translations:a.filter(e=>"popular"===e.category)},{category:"modern",label:"Modern Translations",translations:a.filter(e=>"modern"===e.category)},{category:"traditional",label:"Traditional Translations",translations:a.filter(e=>"traditional"===e.category)},{category:"specialized",label:"Specialized Translations",translations:a.filter(e=>"specialized"===e.category)},{category:"historical",label:"Historical Translations",translations:a.filter(e=>"historical"===e.category)}].filter(e=>e.translations.length>0)}async function c(e){return(await o()).find(a=>a.id===e)||null}function d(e){return"ESV"===e||"esv"===e}}};var a=require("../../../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),r=a.X(0,[30,249,472,609],()=>t(75093));module.exports=r})();