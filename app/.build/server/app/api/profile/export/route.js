"use strict";(()=>{var e={};e.id=325,e.ids=[325],e.modules={53524:e=>{e.exports=require("@prisma/client")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{e.exports=require("assert")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},86624:e=>{e.exports=require("querystring")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},71568:e=>{e.exports=require("zlib")},59202:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>h,patchFetch:()=>f,requestAsyncStorage:()=>g,routeModule:()=>m,serverHooks:()=>x,staticGenerationAsyncStorage:()=>y});var r={};a.r(r),a.d(r,{GET:()=>u,dynamic:()=>c});var i=a(79182),s=a(72007),n=a(56719),o=a(93442),d=a(57978),l=a(11826),p=a(83178);let c="force-dynamic";async function u(e){try{let e=await (0,d.getServerSession)(l.L);if(!e)return o.NextResponse.json({message:"Unauthorized"},{status:401});let[t,a,r,i,s]=await Promise.all([p._.user.findUnique({where:{id:e.user.id},select:{id:!0,name:!0,email:!0,createdAt:!0,timezone:!0,preferredReadingTime:!0,notificationsEnabled:!0,theme:!0,fontSize:!0}}),p._.readingProgress.findMany({where:{userId:e.user.id},include:{dailyReading:{select:{day:!0,ntPassages:!0,otPassages:!0,totalEstimatedMinutes:!0}}},orderBy:{createdAt:"asc"}}),p._.note.findMany({where:{userId:e.user.id},include:{dailyReading:{select:{day:!0,ntPassages:!0,otPassages:!0}}},orderBy:{createdAt:"asc"}}),p._.userAchievement.findMany({where:{userId:e.user.id},include:{achievement:{select:{name:!0,description:!0,category:!0}}},orderBy:{earnedAt:"asc"}}),p._.readingStreak.findUnique({where:{userId:e.user.id}})]),n={exportDate:new Date().toISOString(),user:{name:t?.name,email:t?.email,joinDate:t?.createdAt,preferences:{timezone:t?.timezone,preferredReadingTime:t?.preferredReadingTime,notificationsEnabled:t?.notificationsEnabled,theme:t?.theme,fontSize:t?.fontSize}},readingProgress:a.map(e=>({day:e.dailyReading.day,passages:[...e.dailyReading.ntPassages||[],...e.dailyReading.otPassages||[]],estimatedMinutes:e.dailyReading.totalEstimatedMinutes,isCompleted:e.isCompleted,completedAt:e.completedAt,readingTimeSeconds:e.totalReadingTimeSeconds,currentCycle:e.otCycle,createdAt:e.createdAt})),notes:r.map(e=>({day:e.dailyReading.day,passages:[...e.dailyReading.ntPassages||[],...e.dailyReading.otPassages||[]],content:e.content,createdAt:e.createdAt,updatedAt:e.updatedAt})),achievements:i.map(e=>({name:e.achievement.name,description:e.achievement.description,category:e.achievement.category,earnedAt:e.earnedAt})),streak:{currentStreak:s?.currentStreak||0,longestStreak:s?.longestStreak||0,lastReadingDate:s?.lastReadingDate},statistics:{totalDaysCompleted:a.filter(e=>e.isCompleted).length,totalNotes:r.length,totalAchievements:i.length,averageReadingTime:a.filter(e=>e.totalReadingTimeSeconds).length>0?Math.round(a.filter(e=>e.totalReadingTimeSeconds).reduce((e,t)=>e+(t.totalReadingTimeSeconds||0),0)/a.filter(e=>e.totalReadingTimeSeconds).length):0}};return new o.NextResponse(JSON.stringify(n,null,2),{headers:{"Content-Type":"application/json","Content-Disposition":`attachment; filename="berean-data-${new Date().toISOString().split("T")[0]}.json"`}})}catch(e){return console.error("Data export error:",e),o.NextResponse.json({message:"Internal server error"},{status:500})}}let m=new i.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/profile/export/route",pathname:"/api/profile/export",filename:"route",bundlePath:"app/api/profile/export/route"},resolvedPagePath:"/home/ubuntu/berean-bible-app/app/app/api/profile/export/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:g,staticGenerationAsyncStorage:y,serverHooks:x}=m,h="/api/profile/export/route";function f(){return(0,n.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:y})}},11826:(e,t,a)=>{a.d(t,{L:()=>o});var r=a(64617),i=a(66291),s=a(81304),n=a(83178);let o={adapter:(0,r.N)(n._),providers:[(0,i.Z)({name:"credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)return null;let t=await n._.user.findUnique({where:{email:e.email}});return t&&t.password&&await s.ZP.compare(e.password,t.password)?{id:t.id,email:t.email,name:t.name,image:t.image}:null}})],session:{strategy:"jwt",maxAge:2592e3},callbacks:{jwt:async({token:e,user:t})=>(t&&(e.id=t.id),e),session:async({session:e,token:t})=>(t&&(e.user.id=t.id),e)},secret:process.env.NEXTAUTH_SECRET}},83178:(e,t,a)=>{a.d(t,{_:()=>i});var r=a(53524);let i=globalThis.prisma??new r.PrismaClient}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[30,249,472,609],()=>a(59202));module.exports=r})();